---
layout: post
title: 'Handoff in Safari: How To Transfer Browsing State in Spree Commerce'
---

<p><span id="docs-internal-guid-948dab61-878e-1b39-288e-2f62aea52363"><span>Last week at Apple’s Worldwide Developer Conference several continuity features were announced for iOS 8 and OS X Yosemite. One of them is called “Handoff.” This feature lets you hand-off an activity from one device to another. For example, if you’re looking at Safari on your iPhone but want to move over to your iPad or Mac you can resume browsing on the other device right where you left off.</span>
</span>
</p>
<p><span><span><span id="docs-internal-guid-948dab61-878f-2b46-548f-3917f4e9a6cd"><span>I was excited by the possibilities but when I got into the details I found it is mostly targeted at Handoffs between:</span>
</span>
</span>
</span>
</p>
<ul>
<li>a native app to a website</li>
<li>a website to a native app</li>
</ul>

<p><span><span><span><span id="docs-internal-guid-948dab61-878f-9c35-1643-6b32e2d4391a"><span>A website to website Handoff is possible but limited.</span>
</span>
</span>
</span>
</span>
</p>
<h3><span><span id="docs-internal-guid-bf031b85-8790-9afe-3bcd-e7fafb0651a2"><span>State Transfer and eCommerce</span>
</span>
</span>
</h3>
<p><span id="docs-internal-guid-948dab61-8790-5468-27e8-66a10cda0d56">The problem is during a Handoff, Safari just passes the URL over to the receiving device. "State" such as cookies, is not transferred. If you’re shopping at your favourite online store, add a few items to your cart and switch to another device, it’s going to load the online store, but <em>not</em> the contents of your cart.</span>
</p>
<h3><span><span id="docs-internal-guid-bf031b85-8790-9afe-3bcd-e7fafb0651a2"><span>Transferring Cart Contents in Spree</span>
</span>
</span>
</h3>
<p><span><span><span><span id="docs-internal-guid-948dab61-8791-2e68-377b-c252000e208a"><span>In order to transfer state we need to take advantage of the URL. I’ve been working on a proof of concept that does this in Spree Commerce. Once you’ve added something to your cart, we’ll append a parameter to all URLs which contains the order number for your current order.</span>
</span>
</span>
</span>
</span>
</p>
<p>The receiving device knows this order number does not belong to this new cart, which triggers the contents of that order to be transferred to the receiving cart.</p>
<h3>Proof of Concept</h3>
<p><iframe src="//player.vimeo.com/video/97625034"   frameborder="0"></iframe>
</p>
<p>Source code is available here <a href="https://gist.github.com/djones/80394768b4e2cd0505ab">https://gist.github.com/djones/80394768b4e2cd0505ab</a>
</p>
<h3>Further Considerations</h3>
<p><span><span><span id="docs-internal-guid-948dab61-8795-3bff-eb99-e46b9527ed23"><span>The receiving device may already have some items in its cart, so how do you handle conflicts? Perhaps prompting the user if they want to use the new cart instead is a solution.&#160;</span>
</span>
</span>
</span>
</p>
<p><span id="docs-internal-guid-948dab61-8795-5536-8018-509900dcfbd0"><span>Another issue is the need for an extra parameter on all URLs. This is not desirable so perhaps this would only happen if a supported browser and operating system was detected.</span>
</span>
</p>
<h3>The Future</h3>
<p><span id="docs-internal-guid-948dab61-8795-9ec6-f3fe-35ee697f4715"><span>I hope Apple will add more advanced support for Handoff in Safari in the future. One might first think bringing cookies over would be a sound thing to do, but it creates complexities when the receiving device already has those cookies. Either way iOS 8 and OS X Yosemite greatly improve the user experience between multiple devices and I look forward to seeing where it goes next.</span>
</span>
</p>
<hr /><br /><p>Thinking about replatforming? Read&#160;<a href="/blog/posts/migrating-to-spree-commerce" title="/blog/posts/migrating-to-spree-commerce">Migrating to Spree Commerce</a>
<span style="background-color: transparent;">&#160;</span>
</p>
